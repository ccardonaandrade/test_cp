<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.290">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ZLG ING - Business Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="report_cp_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_cp_files/libs/quarto-html/quarto.js"></script>
<script src="report_cp_files/libs/quarto-html/popper.min.js"></script>
<script src="report_cp_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="report_cp_files/libs/quarto-html/anchor.min.js"></script>
<link href="report_cp_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_cp_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="report_cp_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="report_cp_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="report_cp_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="report_cp_files/libs/quarto-contrib/intersection-observer-polyfill-1.0.0/intersection-observer.js"></script>
<script src="report_cp_files/libs/quarto-contrib/scrollama-3.2.0/scrollama.min.js"></script>
<script src="report_cp_files/libs/quarto-contrib/closeread-0.1.0/closeread.js"></script>

<script src="report_cp_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="report_cp_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<meta cr-debug-mode="false">
<meta cr-remove-header-space="false">


<link rel="stylesheet" href="_extensions/qmd-lab/closeread/closeread.css">
<link rel="stylesheet" href="msaz.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Jump to</h2>
   
  <ul>
  <li><a href="#objective-i" id="toc-objective-i" class="nav-link active" data-scroll-target="#objective-i">Objective I</a>
  <ul class="collapse">
  <li><a href="#most-popular-products" id="toc-most-popular-products" class="nav-link" data-scroll-target="#most-popular-products">10 most popular products</a></li>
  <li><a href="#clients-with-the-most-unfulfilled-orders" id="toc-clients-with-the-most-unfulfilled-orders" class="nav-link" data-scroll-target="#clients-with-the-most-unfulfilled-orders">3 clients with the most unfulfilled orders</a></li>
  <li><a href="#what-happened-during-the-first-quarter-of-2023" id="toc-what-happened-during-the-first-quarter-of-2023" class="nav-link" data-scroll-target="#what-happened-during-the-first-quarter-of-2023">What happened during the first quarter of 2023?</a></li>
  </ul></li>
  <li><a href="#objective-ii" id="toc-objective-ii" class="nav-link" data-scroll-target="#objective-ii">Objective II</a>
  <ul class="collapse">
  <li><a href="#how-do-customers-respond-after-a-delivery-failure" id="toc-how-do-customers-respond-after-a-delivery-failure" class="nav-link" data-scroll-target="#how-do-customers-respond-after-a-delivery-failure">How do customers respond after a delivery failure?</a></li>
  <li><a href="#how-do-reordering-and-non-reordering-customers-differ" id="toc-how-do-reordering-and-non-reordering-customers-differ" class="nav-link" data-scroll-target="#how-do-reordering-and-non-reordering-customers-differ">How do reordering and non-reordering customers differ?</a></li>
  <li><a href="#how-long-are-taking-to-reorder" id="toc-how-long-are-taking-to-reorder" class="nav-link" data-scroll-target="#how-long-are-taking-to-reorder">How long are taking to reorder?</a></li>
  <li><a href="#what-should-be-the-decision" id="toc-what-should-be-the-decision" class="nav-link" data-scroll-target="#what-should-be-the-decision">What should be the decision?</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ZLG ING - Business Analysis</h1>
<p class="subtitle lead">Data Analyst Test</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This report examines ZLG.inc’s order data to assess challenges related to unfulfilled orders and evaluate the CEO’s claim about reorder behavior. We highlight key product demand trends, client-level impacts, and financial losses due to inventory shortages.</p>
<p>We also analyze ordering patterns from January to March 2023—right after the POS system change—and test whether clients reordered the same products within 60 days at equal or higher quantities.</p>
<p>Our aim is to offer a data-backed recommendation on the value of investing in improved warehouse management.</p>
<p>Any comments or questions? Feel free to reach out:</p>
<p><svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M64 112c-8.8 0-16 7.2-16 16v22.1L220.5 291.7c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16H64zM48 212.2V384c0 8.8 7.2 16 16 16H448c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0L48 212.2zM0 128C0 92.7 28.7 64 64 64H448c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128z"></path></svg> <a href="mailto:ccardonaandrade@gmail.com">ccardonaandrade@gmail.com</a></p>
<section id="objective-i" class="level2">
<h2 class="anchored" data-anchor-id="objective-i">Objective I</h2>
<section id="most-popular-products" class="level3">
<h3 class="anchored" data-anchor-id="most-popular-products">10 most popular products</h3>
<p>Which products lead the pack in customer demand? The table shows the top 10 products by total ordered quantity, displaying each product’s volume contribution percentage, revenue generation, and financial impact percentage across the portfolio.</p>
<p><strong>Conclusions:</strong></p>
<ul>
<li><p>Product <code>3016012</code> dominates volume with 63,500 units (17.93% of orders) but contributes minimally to revenue (0.08%).</p></li>
<li><p>Product <code>97403</code> ranks third in quantity but generates the highest revenue ($1.7M), indicating it’s a high-value item with strong demand.</p></li>
<li><p>Volume doesn’t equal profit - the top revenue contributors (products <code>97403</code> and <code>5482401</code>) aren’t the highest-volume sellers.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Top 10 Most Popular Products by Total Order Quantity</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Product Number</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Total Ordered Quantity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Participation Quantity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Total Ordered Amount</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Participation Amount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">3016012</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">63500</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">17.93</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">38954.43</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">0.08</td>
</tr>
<tr class="even">
<td style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">5482401</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">22972</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">6.49</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">1390084.84</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">2.86</td>
</tr>
<tr class="odd">
<td style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">97403</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">18621</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">5.26</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">1719265.18</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">3.54</td>
</tr>
<tr class="even">
<td style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">5100500</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">13700</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">3.87</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">15973.39</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">0.03</td>
</tr>
<tr class="odd">
<td style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">505018</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">9733</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">2.75</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">720309.35</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">1.48</td>
</tr>
<tr class="even">
<td style="text-align: center;">6598405</td>
<td style="text-align: right;">8446</td>
<td style="text-align: right;">2.38</td>
<td style="text-align: right;">897852.30</td>
<td style="text-align: right;">1.85</td>
</tr>
<tr class="odd">
<td style="text-align: center;">8720790</td>
<td style="text-align: right;">7981</td>
<td style="text-align: right;">2.25</td>
<td style="text-align: right;">732083.84</td>
<td style="text-align: right;">1.51</td>
</tr>
<tr class="even">
<td style="text-align: center;">8223018</td>
<td style="text-align: right;">7202</td>
<td style="text-align: right;">2.03</td>
<td style="text-align: right;">253527.58</td>
<td style="text-align: right;">0.52</td>
</tr>
<tr class="odd">
<td style="text-align: center;">14407</td>
<td style="text-align: right;">7032</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">1157772.18</td>
<td style="text-align: right;">2.38</td>
</tr>
<tr class="even">
<td style="text-align: center;">5482013</td>
<td style="text-align: right;">7000</td>
<td style="text-align: right;">1.98</td>
<td style="text-align: right;">6338.44</td>
<td style="text-align: right;">0.01</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="clients-with-the-most-unfulfilled-orders" class="level3">
<h3 class="anchored" data-anchor-id="clients-with-the-most-unfulfilled-orders">3 clients with the most unfulfilled orders</h3>
<p>Unfulfilled orders can signal bottlenecks. The next table identifies the three clients with the highest number of unfulfilled orders, showing both the quantity of non-delivered orders and the financial impact of these missed opportunities.</p>
<p><strong>Conclusions:</strong></p>
<ul>
<li><p>Client <code>79016870</code> represents the greatest financial loss ($27,592.57) despite having fewer unfulfilled orders than the top client, suggesting these are higher-value transactions that should be prioritized.</p></li>
<li><p>While these three clients account for 208 unfulfilled orders worth $65,770.72, they represent only about 9.5% of the total 2,194 unfulfilled orders, indicating that addressing their issues would solve only a small portion of the overall fulfillment problem.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Top 3 clients with the most unfulfilled orders</caption>
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Costumer Number</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Total Non-Delivered Orders</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Total Amount Lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">74843000</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">15313.27</td>
</tr>
<tr class="even">
<td style="text-align: center;">79016870</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">27592.57</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2375900</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">22864.88</td>
</tr>
<tr class="even">
<td style="text-align: center; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">Total</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;"></td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(215, 38, 30, 255) !important;">65770.72</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="what-happened-during-the-first-quarter-of-2023" class="level3">
<h3 class="anchored" data-anchor-id="what-happened-during-the-first-quarter-of-2023">What happened during the first quarter of 2023?</h3>
<p>The visual analysis below breaks down trends in order volume, lost revenue, and delivery issues from June 2022 to June 2023—with a focus on patterns emerging between January and March 2023. Use the tabs to explore each dimension.</p>
<p><strong>Conclusions:</strong></p>
<ul>
<li><p>Order quantities reached their peak in January 2023 before steadily declining through March.</p></li>
<li><p>Loss amounts were consistently high throughout Q1 2023, with multiple extreme spikes indicating systematic fulfillment issues.</p></li>
<li><p>Average order values declined notably during Q1 2023, suggesting a shift toward lower-priced items.</p></li>
<li><p>The share of non-delivered orders increased dramatically in late Q1 2023, reaching the highest levels of the entire analysis period.</p></li>
<li><p>Asia consistently dominates monthly order shares, while Europe and the Americas trade places as distant seconds—highlighting Asia’s key role in demand.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Ordered Quantity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Lost Amount</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Price and Shared of Non Deliveries</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">Geographical Origin</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="report_cp_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="report_cp_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="report_cp_files/figure-html/unnamed-chunk-7-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="report_cp_files/figure-html/unnamed-chunk-8-1.svg" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="objective-ii" class="level2">
<h2 class="anchored" data-anchor-id="objective-ii">Objective II</h2>
<section id="how-do-customers-respond-after-a-delivery-failure" class="level3">
<h3 class="anchored" data-anchor-id="how-do-customers-respond-after-a-delivery-failure">How do customers respond after a delivery failure?</h3>
<p>The plot below shows whether customers reordered the same product within 60 days following an unsuccessful delivery.</p>
<p><strong>Conclusions:</strong></p>
<p>A <strong>majority of customers reordered the product</strong> after a failed delivery, suggesting that delivery issues do not entirely deter customers from trying again. This could indicate:</p>
<ul>
<li><p>Strong product demand or loyalty.</p></li>
<li><p>Customers may attribute the failure to external factors rather than the product or seller.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="report_cp_files/figure-html/unnamed-chunk-9-1.svg" class="quarto-discovered-preview-image img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="how-do-reordering-and-non-reordering-customers-differ" class="level3">
<h3 class="anchored" data-anchor-id="how-do-reordering-and-non-reordering-customers-differ">How do reordering and non-reordering customers differ?</h3>
<p>What is the cost of losing a customer? These visuals highlight the differences in average lost revenue and failed quantities between return customers and those who never came back.</p>
<p><strong>Conclusions:</strong></p>
<ul>
<li><p>Customers with larger failed quantities are more likely to reorder, perhaps because the stakes are higher for them.</p></li>
<li><p>Meanwhile, a higher financial loss correlates with a greater chance that a customer will not return — highlighting the importance of minimizing and recovering from large financial impacts in delivery failures.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="report_cp_files/figure-html/unnamed-chunk-10-1.svg" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="how-long-are-taking-to-reorder" class="level3">
<h3 class="anchored" data-anchor-id="how-long-are-taking-to-reorder">How long are taking to reorder?</h3>
<p>The following plot shows how long it takes customers to reorder after a failed delivery.</p>
<p><strong>Conclusions:</strong></p>
<ul>
<li><p>Most customers reorder between 15 and 30 days after a failure.</p></li>
<li><p>There’s a significant delay before they return — few reorder immediately.</p></li>
<li><p>The peak reorder time is around 20–25 days, meaning it takes 3+ weeks on average for the business to recover the revenue from a failed order.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="report_cp_files/figure-html/unnamed-chunk-11-1.svg" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="what-should-be-the-decision" class="level3">
<h3 class="anchored" data-anchor-id="what-should-be-the-decision">What should be the decision?</h3>
<p>Upgrading the warehouse system will not only reduce order failures but also accelerate reorders and enhance customer loyalty. It’s an investment in both <strong>customer retention</strong> and <strong>financial stability</strong>.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>